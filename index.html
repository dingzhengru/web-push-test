<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web Push Test</title>
  </head>
  <body>
    <h1>Web Push Test</h1>
    <p>參考: https://developers.google.com/web/fundamentals/codelabs/push-notifications?hl=zh-tw</p>
    <p>參考: https://github.com/web-push-libs/web-push</p>

    <h2>gcm sender id</h2>
    <p>創建 firebase 專案來取得</p>

    <h2>VAPID 密鑰</h2>
    <p style="font-weight: bold">通常只會產生一次，就固定使用，因為一旦改掉，已訂閱的資訊就會沒用了</p>
    <p>先執行 npm run gen-keys 來創建 VAPID 公私鑰 => 執行後端 server (npm start)</p>
    <p>或是直接 `npm install -g web-push` 再 `web-push generate-vapid-keys`，再創檔案放入即可(publicKey, privateKey)</p>

    <span>[Public Key]</span>
    <p id="public-key"></p>

    <span>[Private Key]</span>
    <p id="private-key"></p>

    <h2>訂閱</h2>
    <p>檢查訂閱狀態 => 點下訂閱按鈕 => 訂閱 || 取消訂閱 => 後端紀錄訂閱資料(推送需要用到)</p>

    <button id="subscription" disabled>訂閱</button>

    <h2>推送</h2>
    <p>取得訂閱資訊(資料庫) => 推送訊息給指定訂閱者</p>
    <p>於 sw.js 設置接收推送事件</p>

    <form onsubmit="pushMessageToAll(event)">
      <input id="push-message-text" type="text" required />
      <button type="submit">推送訊息</button>
    </form>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="api.js"></script>
    <script src="main.js"></script>
    <script></script>
  </body>
</html>
